= Руководство по Hibernate. Архитектура.
:imagesdir: ../../../assets/img/java/data-persistence/hibernate/

*Hibernate* – это *ORM* фреймворк для *Java* с открытым исходным кодом. Эта технология является крайне мощной и имеет высокие показатели производительности.

*Hibernate* создаёт связь между таблицами в базе данных (далее – БД) и Java-классами и наоборот. Это избавляет разработчиков от огромного количества лишней, рутинной работы, в которой крайне легко допустить ошибку и крайне трудно потом её найти.

Схематично это можно изобразить следующим образом:

image::hibernate-schema.png[Java-Hibernate-Database, align=center]

Какие же преимущества даёт нам использование *Hibernate*?

* Обеспечивает простой API для записи и получения Java-объектов в/из БД.
* Минимизирует доступ к БД, используя стратегии fetching.
* Не требует сервера приложения.
* Позволяет не работать с типами данных языка SQL, а иметь дело с привычными типами данных Java.
* Заботится о создании связей между Java-классами и таблицами БД с помощью XML-файлов не внося изменения в программный код.
* Если необходимо изменить БД, то достаточно лишь внести изменения в XML-файлы.
* *Hibernate* поддерживает все основные СУБД: MySQL, Oracle, PostgreSQL, Microsoft SQL Server Database, HSQL, DB2.
* *Hibernate* также может работать в связке с такими технологиями, как *Maven* и *Jakarta EE*.

== Архитектура

Приложение, которе использует *Hibernate* (в крайне поверхностном представлении) имеет такую архитектуру:

image::hibernate-arch.png[Hibernate-Architecture, align=center]

Если рассмотреть строение самого *Hibernate* более подробно, что этот же рисунок будет выглядеть следующим образом:

image::hibernate-arch-detailed.png[Hibernate-Architecture-Detailed, align=center]

*Hibernate* поддерживает такие *API*, как:

* *JDBC* обеспечивает простейший уровень абстракции функциональности для реляционных БД.
* *JTA* позволяют *Hibernate* использовать серверы приложений *Jakarta EE*.
* *JNDI* позволяют *Hibernate* использовать серверы приложений *Jakarta EE*.

=== Transaction

Этот объект представляет собой рабочую единицу работы с БД. В *Hibernate* транзакции обрабатываются *менеджером транзакций*.

=== SessionFactory

Самый важный и самый тяжёлый объект (обычно создаётся в единственном экземпляре, при запуске приложения). Необходима как минимум одна `SessionFactory` для каждой БД, каждый из которых конфигурируется отдельным конфигурационным файлом.

=== Session

*Сессия* используется для получения физического соединения с БД. Обычно, сессия создаётся при необходимости, а после этого закрывается. Это связано с тем, что эти объекты крайне легковесны. Чтобы понять, что это такое, можно сказать, что создание, чтение, изменение и удаление объектов происходит через объект `Session`.

=== Query

Этот объект использует *HQL* или *SQL* для чтения/записи данных из/в БД. Экземпляр запроса используется для связывания параметров запроса, ограничения количества результатов, которые будут возвращены и для выполнения запроса.

=== Configuration

Этот объект используется для создания объекта `SessionFactory` и конфигурирует сам *Hibernate* с помощью конфигурационного XML-файла, который объясняет, как обрабатывать объект `Session`.

=== Criteria

Используется для создания и выполнения объектно-ориентированных запросов для получения объектов.
